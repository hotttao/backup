---
title: 10 JavaScript 事件
date: 2020-08-12
categories:
    - 前端
tags:
	- JavaScript
---
JavaScript与HTML之间的交互是通过事件实现的。事件，就是文档或浏览器窗口中发生的一些特定的交互瞬间。
<!-- more -->

## 1. 事件以及事件处理流程
JavaScript与HTML之间的交互是通过事件实现的。事件，就是文档或浏览器窗口中发生的一些特定的交互瞬间。可以使用侦听器（或处理程序）来预订事件，以便事件发生时执行相应的代码。这种在传统软件工程中被称为观察员模式的模型，支持页面的行为（JavaScript代码）与页面的外观（HTML和CSS代码）之间的松散耦合。

### 1.1 事件流
如果你单击了某个按钮，单击事件不仅仅发生在按钮上。换句话说，在单击按钮的同时，你也单击了按钮的容器元素，甚至也单击了整个页面。事件流描述的是从页面中接收事件的顺序。

事件流有两种完全相反的实现:
1. 事件冒泡: 即事件开始时由最具体的元素（文档中嵌套层次最深的那个节点）接收，然后逐级向上传播到较为不具体的节点
2. 事件捕获: 
    - 事件捕获的思想是不太具体的节点应该更早接收到事件，而最具体的节点应该最后接收到事件
    - 事件捕获的用意在于在事件到达预定目标之前捕获它

尽管“DOM2级事件”规范要求事件应该从document对象开始传播，但大多数浏览器都是从window对象开始捕获事件的。由于老版本的浏览器不支持，因此很少有人使用事件捕获。我们也建议读者放心地使用事件冒泡，在有特殊需要时再使用事件捕获。

#### 事件流的阶段划分
“DOM2级事件”规定的事件流包括三个阶段：事件捕获阶段、处于目标阶段和事件冒泡阶段

![JavaScript](/images/JavaScript/event_process.jpg)

## 2. 事件处理程序
为事件指定处理程序的方式有好几种。

### 2.1 HTML事件处理程序
某个元素支持的每种事件，都可以使用一个与相应事件处理程序同名的HTML特性来指定。

```html
<input type="button" value="Click" onclick="alter('click')">
```

事件处理程序中的代码在执行时，有权访问全局作用域中的任何代码。

#### HTML事件处理程序的缺点
HTML事件处理程序有如下的缺点，导致开发人员更倾向于使用JavaScript指定事件处理程序:
1. HTML指定事件处理程序的最后一个缺点是HTML与JavaScript代码紧密耦合
2. 这样扩展事件处理程序的作用域链在不同浏览器中会导致不同结果。不同JavaScript引擎遵循的标识符解析规则略有差异，很可能会在访问非限定对象成员时出错。
3. 存在一个时差问题。因为用户可能会在HTML元素一出现在页面上就触发相应的事件，但当时的事件处理程序有可能尚不具备执行条件。为此，很多HTML事件处理程序都会被封装在一个try-catch块中，以便错误不会浮出水面

### 2.2 DOM0级事件处理程序